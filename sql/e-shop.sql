# DROP DATABASE e_shop;
-- ÈÅ©Áî®Êñº MySQL + InnoDB + utf8mb4

CREATE DATABASE IF NOT EXISTS e_shop CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE e_shop;

-- ÂïÜÂìÅÂàÜÈ°ûË°®
CREATE TABLE product_category
(
    product_category_id   INT AUTO_INCREMENT PRIMARY KEY,
    product_category_name VARCHAR(32) UNIQUE NOT NULL,
    created_at            DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at            DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE = InnoDB;

-- ÂïÜÂìÅË°®
CREATE TABLE product
(
    product_no          INT AUTO_INCREMENT PRIMARY KEY,
    product_name        VARCHAR(32) UNIQUE NOT NULL,
    product_desc        TEXT,
    product_add_qty     INT,
    remaining_qty       INT,
    product_add_time    DATETIME DEFAULT CURRENT_TIMESTAMP,
    product_remove_time DATETIME,
    product_status      TINYINT CHECK (product_status IN (0, 1)),
    product_category_id INT,
    product_price       DECIMAL(10, 2),
    FOREIGN KEY (product_category_id) REFERENCES product_category (product_category_id)
        ON DELETE RESTRICT ON UPDATE CASCADE
) ENGINE = InnoDB;

-- ÂïÜÂìÅÂúñÁâáË°®
CREATE TABLE product_img
(
    product_img_no  INT AUTO_INCREMENT PRIMARY KEY,
    product_no      INT,
    product_img_url VARCHAR(500) NOT NULL,
    img_order       INT,
    created_at      DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (product_no) REFERENCES product (product_no)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

-- ÊúÉÂì°Ë≥áÊñôË°®
CREATE TABLE member
(
    member_id  INT AUTO_INCREMENT PRIMARY KEY,
    username   VARCHAR(50) UNIQUE,
    password   VARCHAR(255)        NULL,
    email      VARCHAR(100) UNIQUE NOT NULL,                                   -- email ÂøÖÈ†àÂîØ‰∏Ä‰∏î‰∏çÂèØÁÇ∫ NULL
    login_type VARCHAR(20)         NULL,                                       -- ÁôªÂÖ•ÊñπÂºèÔºà‰æãÂ¶ÇÔºölocal, googleÔºâ
    google_sub VARCHAR(100) UNIQUE,                                            -- ÂÑ≤Â≠ò Google OAuth ÁöÑ subÔºàÂîØ‰∏ÄË≠òÂà•Ôºâ
    name       VARCHAR(50)         NULL,                                       -- ÂßìÂêçÔºàÂèØ‰ª•ÁÇ∫ NULLÔºâ
    phone      VARCHAR(20)         NULL,                                       -- ÊâãÊ©üËôüÁ¢ºÔºàÂèØ‰ª•ÁÇ∫ NULLÔºâ
    status     TINYINT  DEFAULT 1 CHECK (status IN (0, 1)),                    -- ÁãÄÊÖãÊ¨Ñ‰ΩçÔºö1 = ÂïüÁî®Ôºå0 = ÂÅúÁî®
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,                             -- Ë®ªÂÜäÊôÇÈñì
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, -- Êõ¥Êñ∞ÊôÇÈñì
    birthday   DATE                NULL,                                       -- ÁîüÊó•ÔºàÂèØ‰ª•ÁÇ∫ NULLÔºâ
    CONSTRAINT email_unique UNIQUE (email),                                    -- Á¢∫‰øù email ÂîØ‰∏Ä
    CONSTRAINT google_sub_unique UNIQUE (google_sub),                          -- Á¢∫‰øù google_sub ÂîØ‰∏Ä
    CONSTRAINT username_unique UNIQUE (username)                               -- Á¢∫‰øù username ÂîØ‰∏Ä
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8mb4
  COLLATE = utf8mb4_general_ci;


-- ÂïÜÂìÅË©ïË´ñË°®
CREATE TABLE product_comment
(
    comment_id   INT AUTO_INCREMENT PRIMARY KEY,
    product_no   INT,
    member_id    INT,
    rating       TINYINT CHECK (rating BETWEEN 1 AND 5),
    comment_text TEXT,
    comment_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    status       TINYINT CHECK (status IN (-1, 0, 1)),
    FOREIGN KEY (product_no) REFERENCES product (product_no)
        ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (member_id) REFERENCES member (member_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

-- ÁÆ°ÁêÜÂì°Â∏≥ËôüË°®
CREATE TABLE admin
(
    admin_id   INT AUTO_INCREMENT PRIMARY KEY,
    username   VARCHAR(50) UNIQUE NOT NULL,
    password   VARCHAR(255)       NOT NULL,
    name       VARCHAR(50)        NOT NULL,
    email      VARCHAR(100),
    role       VARCHAR(30),
    status     TINYINT CHECK (status IN (0, 1)),
    last_login DATETIME,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE = InnoDB;

-- ÂïÜÂìÅÁïôË®ÄÊ™¢ËàâË°®
CREATE TABLE comment_report
(
    report_id    INT AUTO_INCREMENT PRIMARY KEY,
    comment_id   INT,
    member_id    INT,
    reason       VARCHAR(100) NOT NULL,
    report_time  DATETIME DEFAULT CURRENT_TIMESTAMP,
    comment_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    status       TINYINT CHECK (status IN (0, 1, 2)),
    admin_id     INT,
    handle_time  DATETIME,
    reply        VARCHAR(255),

    FOREIGN KEY (comment_id) REFERENCES product_comment (comment_id)
        ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (member_id) REFERENCES member (member_id)
        ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (admin_id) REFERENCES admin (admin_id)
        ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE = InnoDB
  DEFAULT CHARSET = utf8mb4
  COLLATE = utf8mb4_unicode_ci;


-- ÁÆ°ÁêÜÂì°Êìç‰ΩúÁ¥ÄÈåÑË°®
CREATE TABLE admin_log
(
    log_id       INT AUTO_INCREMENT PRIMARY KEY,     -- ‰∏ªÈçµÔºåHibernate Â∞çÊáâ logId
    admin_id     INT          NULL,                  -- Â§ñÈçµÔºöÁÆ°ÁêÜÂì° ID
    action_type  VARCHAR(50)  NOT NULL,              -- Êìç‰ΩúÈ°ûÂûãÔºölogin, edit_product, review_comment Á≠â
    target_table VARCHAR(50)  NULL,                  -- Ë¢´Êìç‰ΩúÁöÑË≥áÊñôË°®ÔºåÂ¶Ç product, coupon
    target_id    VARCHAR(50)  NULL,                  -- Ë¢´Êìç‰ΩúË≥áÊñô‰∏ªÈçµ ID
    action_desc  VARCHAR(255) NULL,                  -- Êìç‰ΩúË™™ÊòéÔºö‰æãÂ¶Ç„ÄåÂ∞ÅÈéñ‰∏çÁï∂ÁïôË®Ä„Äç
    ip_address   VARCHAR(50)  NULL,                  -- Êìç‰Ωú‰æÜÊ∫ê IP ‰ΩçÂùÄ
    created_at   DATETIME DEFAULT CURRENT_TIMESTAMP, -- Âª∫Á´ãÊôÇÈñìÔºàËá™ÂãïÂ∏∂ÂÖ•Ôºâ

    -- Â§ñÈçµÁ¥ÑÊùü
    CONSTRAINT fk_admin_log_admin
        FOREIGN KEY (admin_id) REFERENCES admin (admin_id)
            ON UPDATE CASCADE
            ON DELETE CASCADE
);

-- üîç Âª∫Ë≠∞ÁöÑÁ¥¢ÂºïÔºàÊèêÂçáÊü•Ë©¢ÊïàÁéáÔºâ
CREATE INDEX idx_admin_id ON admin_log (admin_id);
CREATE INDEX idx_action_type ON admin_log (action_type);
CREATE INDEX idx_target_table ON admin_log (target_table);

-- Ë®ÇÂñÆ‰∏ªË°®
CREATE TABLE orders
(
    order_id            INT AUTO_INCREMENT PRIMARY KEY,
    member_id           INT,
    order_date          DATETIME       DEFAULT CURRENT_TIMESTAMP,
    total_amount        DECIMAL(10, 2),
    discount_amount     DECIMAL(10, 2) DEFAULT 0.00, -- ÊäòÊâ£ÈáëÈ°çÔºàÊñ∞Â¢ûÔºâ
    applied_coupon_code VARCHAR(50),                 -- ‰ΩøÁî®ÁöÑÂÑ™ÊÉ†Âà∏‰ª£Á¢ºÔºàÊñ∞Â¢ûÔºâ
    payment_status      TINYINT CHECK (payment_status IN (0, 1)),
    shipping_status     TINYINT CHECK (shipping_status IN (0, 1)),
    receiver_name       VARCHAR(50),
    receiver_phone      VARCHAR(20),
    receiver_address    VARCHAR(255),
    note                VARCHAR(255),
    created_at          DATETIME       DEFAULT CURRENT_TIMESTAMP,
    updated_at          DATETIME       DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (member_id) REFERENCES member (member_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;


-- Ë®ÇÂñÆÊòéÁ¥∞Ë°®
CREATE TABLE order_item
(
    order_item_id INT AUTO_INCREMENT PRIMARY KEY,
    order_id      INT,
    product_no    INT,
    quantity      INT,
    unit_price    DECIMAL(10, 2),
    subtotal      DECIMAL(10, 2),
    FOREIGN KEY (order_id) REFERENCES orders (order_id)
        ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (product_no) REFERENCES product (product_no)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

-- ‰ªòÊ¨æÁ¥ÄÈåÑË°®
CREATE TABLE payment
(
    payment_id        INT AUTO_INCREMENT PRIMARY KEY,
    order_id          INT,
    merchant_trade_no VARCHAR(50) UNIQUE NOT NULL,
    trade_no          VARCHAR(50),
    payment_type      VARCHAR(30),
    payment_status    TINYINT CHECK (payment_status IN (0, 1, 2)),
    paid_at           DATETIME,
    amount            DECIMAL(10, 2),
    return_code       VARCHAR(10),
    return_msg        VARCHAR(100),
    created_at        DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at        DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (order_id) REFERENCES orders (order_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

-- ÊúÉÂì°Âú∞ÂùÄË°®
CREATE TABLE member_address
(
    address_id      INT AUTO_INCREMENT PRIMARY KEY,
    member_id       INT,
    recipient_name  VARCHAR(50),
    recipient_phone VARCHAR(20),
    address         VARCHAR(255),
    created_at      DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at      DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (member_id) REFERENCES member (member_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

-- ÊúÉÂì°ÁôªÂÖ•Á¥ÄÈåÑË°®
CREATE TABLE login_log
(
    log_id     INT AUTO_INCREMENT PRIMARY KEY,
    member_id  INT,
    login_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    ip_address VARCHAR(50),
    login_type VARCHAR(20),
    status     TINYINT CHECK (status IN (0, 1)),
    user_agent VARCHAR(255),
    FOREIGN KEY (member_id) REFERENCES member (member_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

-- Â∏∏Ë¶ãÂïèÈ°åË°®
CREATE TABLE faq
(
    faq_id     INT AUTO_INCREMENT PRIMARY KEY,
    question   VARCHAR(255) NOT NULL,
    answer     TEXT,
    category   VARCHAR(100),
    is_enabled TINYINT CHECK (is_enabled IN (0, 1)),
    sort_order INT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE = InnoDB;

-- ÂÑ™ÊÉ†Âà∏‰∏ªË°®
CREATE TABLE coupon
(
    coupon_id      VARCHAR(50) PRIMARY KEY,
    coupon_code    VARCHAR(50) UNIQUE NOT NULL,
    name           VARCHAR(100),
    discount_type  VARCHAR(10),
    discount_value DECIMAL(10, 2),
    min_spend      DECIMAL(10, 2),
    valid_from     DATETIME,
    valid_to       DATETIME,
    is_enabled     TINYINT CHECK (is_enabled IN (0, 1)),
    description    VARCHAR(255),
    created_at     DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at     DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE = InnoDB;

-- ÂÑ™ÊÉ†Âà∏ÊåÅÊúâË°®
CREATE TABLE coupon_holder
(
    coupon_holder_id INT AUTO_INCREMENT PRIMARY KEY,
    member_id        INT,
    coupon_id        VARCHAR(50),
    coupon_code      VARCHAR(50),
    assigned_time    DATETIME DEFAULT CURRENT_TIMESTAMP,
    used_status      TINYINT CHECK (used_status IN (0, 1, 2, 3)),
    used_time        DATETIME,
    expired_time     DATETIME,
    created_at       DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at       DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (member_id) REFERENCES member (member_id)
        ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (coupon_id) REFERENCES coupon (coupon_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;

-- ÂÑ™ÊÉ†Âà∏Â•óÁî®Á¥ÄÈåÑË°®
CREATE TABLE coupon_used_log
(
    used_id          INT AUTO_INCREMENT PRIMARY KEY,
    order_id         INT,
    coupon_holder_id INT,
    discount_amount  DECIMAL(10, 2),
    member_id        INT,
    applied_time     DATETIME,
    created_at       DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at       DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (order_id) REFERENCES orders (order_id)
        ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (coupon_holder_id) REFERENCES coupon_holder (coupon_holder_id)
        ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (member_id) REFERENCES member (member_id)
        ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE = InnoDB;


-- ÊèíÂÖ•ÂïÜÂìÅÂàÜÈ°û
INSERT INTO product_category (product_category_name)
VALUES ('Êõ∏Á±ç'),
       ('ÈõªÂ≠êÁî¢ÂìÅ'),
       ('ÁîüÊ¥ªÁî®ÂìÅ'),
       ('Â±ÖÂÆ∂Áî®ÂìÅ');

-- ÊèíÂÖ•ÂïÜÂìÅË≥áÊñôÔºàÂÖ±30Á≠ÜÔºâ
INSERT INTO product (product_name, product_desc, product_add_qty, remaining_qty, product_status, product_category_id, product_price)
VALUES
    ('JavaÂÖ•ÈñÄÊõ∏', 'ÈÅ©ÂêàÂàùÂ≠∏ËÄÖÁöÑJavaÊõ∏Á±ç', 50, 50, 1, 1, 580.00),
    ('ËóçÁâôËÄ≥Ê©ü', 'È´òÈü≥Ë≥™ËóçÁâôËÄ≥Ê©ü', 30, 30, 1, 2, 1200.00),
    ('‰∏çÈèΩÈãº‰øùÊ∫´Áì∂', '‰øùÊ∫´ÊïàÊûú‰Ω≥ÔºåÊñπ‰æøÊîúÂ∏∂', 100, 100, 1, 3, 350.00),
    ('ÈõªÁ´∂ÊªëÈº†', 'RGBÁáàÊïàÔºåÈùàÊïèÂ∫¶È´ò', 40, 40, 1, 2, 980.00),
    ('JavaÈ´òÈöéÂØ¶Êà∞', 'ÊèêÂçáÈÄ≤ÈöéÊäÄÂ∑ßÂøÖÂÇô', 35, 35, 1, 1, 760.00),
    ('Ê©üÊ¢∞ÂºèÈçµÁõ§', 'ÊâãÊÑüÊ•µ‰Ω≥ÔºåÊîØÊè¥Â§öÂ™íÈ´îÂø´Êç∑Èçµ', 20, 20, 1, 2, 1800.00),
    ('ÊóÖË°åÁôªÊ©üÁÆ±', '20ÂêãËºïÈáèÊãâÊ°øÁÆ±', 25, 25, 1, 4, 1290.00),
    ('PythonÊïôÂ≠∏Êõ∏', 'ÂúñËß£ÊïôÂ≠∏ÊòìÊáÇ', 45, 45, 1, 1, 620.00),
    ('‰∫∫È´îÂ∑•Â≠∏Ê§Ö', 'Èï∑ÊôÇÈñìÂ∑•‰ΩúËàíÈÅ©ÊîØÊíê', 15, 15, 1, 4, 3200.00),
    ('ÁÑ°Á∑öÊªëÈº†', 'Á∞°Á¥ÑË®≠Ë®à„ÄÅËºïÂ∑ß‰æøÊîú', 50, 50, 1, 2, 490.00),
    ('ÊúâÁ∑öËÄ≥Ê©ü', 'Èü≥Ë≥™Ê∏ÖÊô∞ÔºåÈÄöË©±Á©©ÂÆö', 60, 60, 1, 2, 390.00),
    ('C++ÂØ¶‰ΩúÁØÑ‰æãÊõ∏', 'Êê≠ÈÖçÊ°à‰æãÂø´ÈÄü‰∏äÊâã', 40, 40, 1, 1, 550.00),
    ('Á≠ÜÈõªÊîØÊû∂', 'ÂèØË™øÈ´òÂ∫¶ÔºåÊîπÂñÑÂùêÂßø', 45, 45, 1, 4, 680.00),
    ('ÊéÉÂú∞Ê©üÂô®‰∫∫', 'Êô∫ÊÖßÊÑüÊáâ„ÄÅËá™ÂãïÊ∏ÖÊéÉ', 12, 12, 1, 4, 5200.00),
    ('ÊâãÊ≤ñÂíñÂï°Â£∫', 'Á≤æÁ∑ªÁîüÊ¥ªÂ∞èÁâ©', 30, 30, 1, 3, 850.00),
    ('Êó•Âºè‰æøÁï∂Áõí', 'ÈõôÂ±§Ë®≠Ë®à„ÄÅÂèØÂæÆÊ≥¢', 70, 70, 1, 3, 290.00),
    ('Êô∫ÊÖßÊâãÈå∂', 'ÂÅ•Â∫∑Áõ£Ê∏¨„ÄÅË®äÊÅØÊèêÈÜí', 28, 28, 1, 2, 2280.00),
    ('HDMIÁ∑ö', 'ÊîØÊè¥4KËß£ÊûêÂ∫¶', 90, 90, 1, 2, 250.00),
    ('KotlinÂÖ•ÈñÄÊõ∏', 'Â≠∏ÁøíAndroidÈñãÁôºÊé®Ëñ¶', 38, 38, 1, 1, 540.00),
    ('ÊóÖË°åÈ†∏Êûï', 'UÂûãË®òÊÜ∂Ê£âË®≠Ë®à', 40, 40, 1, 4, 420.00),
    ('Á≠ÜÈõªÂÖßË¢ã', 'ÈÅ©Âêà13-15ÂêãÁ≠ÜÈõª‰ΩøÁî®', 65, 65, 1, 4, 310.00),
    ('USBÂÖÖÈõªÁ∑ö', 'Type-CÂø´ÂÖÖÁ∑ö', 80, 80, 1, 2, 180.00),
    ('Ê°åÈù¢Â∞èÈ¢®Êâá', 'USB‰æõÈõª‰∏âÊÆµÈ¢®ÈÄü', 35, 35, 1, 4, 399.00),
    ('Ê¥óË°£Ë¢ãÁµÑ', '‰∏âÂÖ•Á∂≤ÁãÄ‰øùË≠∑Ë¢ã', 55, 55, 1, 4, 150.00),
    ('ReactÂØ¶Êà∞ÈñãÁôºÊõ∏', 'ÂÆåÊï¥Â∞àÊ°àÁØÑ‰æã', 30, 30, 1, 1, 620.00),
    ('‰øùÂÜ∑‰øùÊ∫´Ë¢ã', 'Â§ñÂá∫ÈáéÈ§êÂ•ΩÂπ´Êâã', 45, 45, 1, 3, 270.00),
    ('ÁÑ°Á∑öÂÖÖÈõªÊùø', 'ÊîØÊè¥Âø´ÂÖÖËàáÂ§öË®≠ÂÇô', 22, 22, 1, 2, 980.00),
    ('Ë°åÂãïÈõªÊ∫ê', '20000mAhÂ§ßÂÆπÈáè', 18, 18, 1, 2, 1350.00),
    ('AndroidÈñãÁôºÊõ∏', 'ÊéåÊè°Áèæ‰ª£AppÈñãÁôºÊäÄË°ì', 25, 25, 1, 1, 650.00),
    ('Ê°åÈù¢Èñ±ËÆÄÁáà', '‰∏âÊÆµ‰∫ÆÂ∫¶ÂèØË™øÔºåË≠∑ÁúºË®≠Ë®à', 33, 33, 1, 4, 860.00); -- ‚úÖ Á¨¨30Á≠Ü

-- ÊèíÂÖ•ÊúÉÂì°
INSERT INTO member (username, password, email, login_type, name, phone, status, birthday)
VALUES ('user1', '$2a$10$cPaDqp2nPB3cDi.KWTYKa.iIFvjDralPzlJ7OnEHIjX03gw3FtMYK', 'user1@test.com', 'local', 'Â∞èÊòé', '0911111111', 1, '1990-01-01'),
       ('user2', '$2a$10$6zCNGWBF0QqeJr2ItA.IMOv8/WxLnspX3pIO8fr1ETeB/mVKL6xZq', 'user2@test.com', 'local', 'Â∞èËèØ', '0922222222', 1, '1992-02-02'),
       ('user3', '$2a$10$dNlmU8qLFTU6BDGYsk2bTOej9tieEueI/29UCUpr1DqBqF6IqafX6', 'user3@test.com', 'local', 'Â∞èÁæé', '0933333333', 1, '1995-03-03');

-- ÊèíÂÖ•ÁÆ°ÁêÜÂì°
INSERT INTO admin (username, password, name, email, role, status)
VALUES ('admin1', '$2a$10$M6ul9qlE/FCDt1y0Tdjl4ex5aDXPGy0rmYpxRJTdTN95WWyPkxfxe', 'ÁÆ°ÁêÜÂì°‰∏Ä', 'admin1@test.com', 'super', 1),
       ('admin2', '$2a$10$HufSr8B/hdQjpAq75FOtV.XmUhUVdAX15qfOvnvWrxZFmNfki9Gj6', 'ÁÆ°ÁêÜÂì°‰∫å', 'admin2@test.com', 'editor', 1),
       ('admin3', '$2a$10$G2m.GIZBJ/VXfCfjks9dLOUGetC0wYCmbZ4EmCpzSWo.Q69UqtEQa', 'ÁÆ°ÁêÜÂì°‰∏â', 'admin3@test.com', 'reviewer', 1);

-- ÂïÜÂìÅË©ïË´ñ
INSERT INTO product_comment (product_no, member_id, rating, comment_text, status)
VALUES (1, 1, 5, 'ÈùûÂ∏∏Ê£íÁöÑÊõ∏ÔºÅ', 1),
       (2, 2, 4, 'ËÄ≥Ê©üÈü≥Ë≥™ÂæàÊ£í', 1),
       (3, 3, 3, 'ÈÇÑÂèØ‰ª•Êé•Âèó', 1);

-- ÂïÜÂìÅÁïôË®ÄÊ™¢Ëàâ
INSERT INTO comment_report (comment_id, member_id, reason, status, admin_id)
VALUES (1, 2, 'ÈáçË§áË©ïË´ñ', 2, 1),
       (2, 3, 'Ë™ûÊ∞£‰∏çÁï∂', 1, 2),
       (3, 1, 'Âª£ÂëäÂ´åÁñë', 0, NULL);

-- ÁÆ°ÁêÜÂì°Êìç‰ΩúÁ¥ÄÈåÑ
INSERT INTO admin_log (admin_id, action_type, target_table, target_id, action_desc, ip_address)
VALUES (1, 'login', 'admin', 1, 'ÁôªÂÖ•ÊàêÂäü', '127.0.0.1'),
       (2, 'edit_product', 'product', 2, '‰øÆÊîπÂïÜÂìÅÊèèËø∞', '127.0.0.2'),
       (3, 'review_comment', 'product_comment', 3, 'ÂØ©Ê†∏ÁïôË®Ä', '127.0.0.3');

-- Ë®ÇÂñÆ‰∏ªË°® (Âê´ÊäòÊâ£ÈáëÈ°çËàáÂÑ™ÊÉ†Âà∏‰ª£Á¢º)
INSERT INTO orders (member_id, total_amount, discount_amount, applied_coupon_code, payment_status, shipping_status,
                    receiver_name, receiver_phone, receiver_address, note)
VALUES (1, 550, 50, 'BIRTHDAY50', 1, 1, 'Alice', '0911000111', 'Âè∞ÂåóÂ∏Ç', 'Âø´ÈÄüÂà∞Ë≤®'),
       (2, 1200, 0, NULL, 1, 0, 'Bob', '0922000222', 'Êñ∞Á´πÂ∏Ç', ''),
       (3, 350, 30, 'WELCOME30', 0, 0, 'Charlie', '0933000333', 'È´òÈõÑÂ∏Ç', 'Âä†Âº∑ÂåÖË£ù');

-- Ë®ÇÂñÆÊòéÁ¥∞
INSERT INTO order_item (order_id, product_no, quantity, unit_price, subtotal)
VALUES (1, 1, 1, 550.00, 550.00),
       (2, 2, 1, 1200.00, 1200.00),
       (3, 3, 1, 350.00, 350.00);

-- ‰ªòÊ¨æÁ¥ÄÈåÑ
INSERT INTO payment (order_id, merchant_trade_no, trade_no, payment_type, payment_status, amount, return_code,
                     return_msg)
VALUES (1, 'T0001', 'TN0001', 'Credit', 1, 550.00, '1', '‰∫§ÊòìÊàêÂäü'),
       (2, 'T0002', 'TN0002', 'WebATM', 1, 1200.00, '1', '‰∫§ÊòìÊàêÂäü'),
       (3, 'T0003', 'TN0003', 'LINEPay', 0, 0.00, '0', 'Êú™‰ªòÊ¨æ');

-- ÊúÉÂì°Âú∞ÂùÄ
INSERT INTO member_address (member_id, recipient_name, recipient_phone, address)
VALUES (1, 'Alice', '0911000111', 'Âè∞ÂåóÂ∏Ç‰∏≠Ê≠£ÂçÄ'),
       (2, 'Bob', '0922000222', 'Êñ∞Á´πÂ∏ÇÊù±ÂçÄ'),
       (3, 'Charlie', '0933000333', 'È´òÈõÑÂ∏ÇÈπΩÂüïÂçÄ');

-- ÁôªÂÖ•Á¥ÄÈåÑ
INSERT INTO login_log (member_id, ip_address, login_type, status, user_agent)
VALUES (1, '127.0.0.1', 'local', 1, 'Chrome'),
       (2, '127.0.0.1', 'google', 1, 'Firefox'),
       (3, '127.0.0.1', 'local', 0, 'Edge');

-- FAQ
INSERT INTO faq (question, answer, category, is_enabled, sort_order)
VALUES ('ÊÄéÈ∫ºË®ªÂÜäÂ∏≥ËôüÔºü', 'ÈªûÂè≥‰∏äËßíË®ªÂÜäÂç≥ÂèØ„ÄÇ', 'ÊúÉÂì°ÂïèÈ°å', 1, 1),
       ('ÊúâÂì™‰∫õ‰ªòÊ¨æÊñπÂºèÔºü', '‰ø°Áî®Âç°„ÄÅLINEPay„ÄÅWebATM', '‰ªòÊ¨æÂïèÈ°å', 1, 2),
       ('ÈÖçÈÄÅÊôÇÈñìÂ§ö‰πÖÔºü', 'ÈÄöÂ∏∏ 1~3 Â§©ÂÖßÂà∞Ë≤®', 'ÈÖçÈÄÅÂïèÈ°å', 1, 3);

-- ÂÑ™ÊÉ†Âà∏
INSERT INTO coupon (coupon_id, coupon_code, name, discount_type, discount_value, min_spend, valid_from, valid_to,
                    is_enabled, description)
VALUES ('C001', 'HBD50', 'ÁîüÊó•ÂÑ™ÊÉ†Âà∏', 'fixed', 50.00, 100.00, NOW(), DATE_ADD(NOW(), INTERVAL 30 DAY), 1, 'ÁîüÊó•Âø´Ê®ÇÔºÅ'),
       ('C002', 'SPRING10', 'Êò•Â≠£ÊäòÊâ£', 'percent', 10.00, 300.00, NOW(), DATE_ADD(NOW(), INTERVAL 15 DAY), 1,
        'ÂÖ®È§®‰πùÊäò'),
       ('C003', 'FREESHIP', 'ÂÖçÈÅãÂà∏', 'fixed', 60.00, 300.00, NOW(), DATE_ADD(NOW(), INTERVAL 7 DAY), 1, 'ÂÖçÈÅãË≤ª');

-- ÂÑ™ÊÉ†Âà∏ÊåÅÊúâ
INSERT INTO coupon_holder (member_id, coupon_id, coupon_code, used_status)
VALUES (1, 'C001', 'HBD50', 0),
       (2, 'C002', 'SPRING10', 1),
       (3, 'C003', 'FREESHIP', 2);

-- Â•óÁî®Á¥ÄÈåÑ
INSERT INTO coupon_used_log (order_id, coupon_holder_id, discount_amount, member_id, applied_time)
VALUES (1, 1, 50.00, 1, NOW()),
       (2, 2, 120.00, 2, NOW()),
       (3, 3, 60.00, 3, NOW());

-- ‚úÖ ÈñãÂïü‰∫ã‰ª∂ÊéíÁ®ãÂô®ÔºàÂè™ÈúÄÂü∑Ë°å‰∏ÄÊ¨°Ôºâ
SET GLOBAL event_scheduler = ON;

-- ‚úÖ ÊØèÂ§©Ê∏ÖÈô§ 7 Â§©ÂâçÁöÑ admin_log
CREATE EVENT IF NOT EXISTS delete_old_admin_log
    ON SCHEDULE EVERY 1 DAY
        STARTS CURRENT_TIMESTAMP
    DO
    DELETE
    FROM admin_log
    WHERE created_at < NOW() - INTERVAL 7 DAY;

-- ‚úÖ ÊØèÂ§©Ê∏ÖÈô§ 7 Â§©ÂâçÁöÑ login_log
CREATE EVENT IF NOT EXISTS delete_old_login_log
    ON SCHEDULE EVERY 1 DAY
        STARTS CURRENT_TIMESTAMP
    DO
    DELETE
    FROM login_log
    WHERE login_time < NOW() - INTERVAL 7 DAY;

-- ‚úÖ ÊØèÂ§©Ê∏ÖÈô§ 7 Â§©ÂâçÁöÑ coupon_used_log
CREATE EVENT IF NOT EXISTS delete_old_coupon_used_log
    ON SCHEDULE EVERY 1 DAY
        STARTS CURRENT_TIMESTAMP
    DO
    DELETE
    FROM coupon_used_log
    WHERE applied_time < NOW() - INTERVAL 7 DAY;
